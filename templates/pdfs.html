{% extends "base.html" %}

{% block title %}Repositorio de PDFs{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="animated-title text-center mb-4">Repositorio de PDFs</h1>
    
    <div class="card shadow mb-5">
        <div class="card-body">
            <h2 class="text-center mb-4">PDFs Disponibles</h2>
            {% if pdfs %}
                <div class="row">
                    {% for pdf in pdfs %}
                    <div class="col-md-6 mb-3">
                        <div class="card h-100">
                            <div class="card-body d-flex align-items-center">
                                <i class="fas fa-file-pdf me-3 text-danger" style="font-size: 2rem;"></i>
                                <a href="{{ url_for('static', filename='pdfs/' + pdf) }}" 
                                   class="pdf-link stretched-link" 
                                   target="_blank"
                                   data-bs-toggle="modal" 
                                   data-bs-target="#pdfPreviewModal"
                                   data-pdf="{{ url_for('static', filename='pdfs/' + pdf) }}">
                                    {{ pdf|replace('.pdf', '')|replace('_', ' ') }}
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="alert alert-info text-center">
                    <i class="fas fa-info-circle me-2"></i>No hay PDFs disponibles en este momento.
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Sección de recursos de aprendizaje -->
    <div class="card shadow mb-5">
        <div class="card-body">
            <h3 class="text-center mb-4">Recursos de Aprendizaje</h3>
            <div class="row g-3 text-center" id="learning-resources-buttons-pdfs">
                <div class="col-md-4 col-sm-6">
                    <a href="https://docs.python.org/es/3/tutorial/" target="_blank" rel="noopener"
                       class="btn btn-outline-primary w-100 h-100 d-flex flex-column py-3 learning-btn-pdf">
                        <i class="fab fa-python fa-2x mb-2"></i>
                        Tutorial Python Oficial
                    </a>
                </div>
                <div class="col-md-4 col-sm-6">
                    <a href="https://greenteapress.com/wp/think-python-2e/" target="_blank" rel="noopener"
                       class="btn btn-outline-success w-100 h-100 d-flex flex-column py-3 learning-btn-pdf">
                        <i class="fas fa-book fa-2x mb-2"></i>
                        Think Python (EN)
                    </a>
                </div>
                <div class="col-md-4 col-sm-6">
                    <a href="https://ocw.mit.edu/courses/6-006-introduction-to-algorithms-fall-2011/pages/lecture-notes/" 
                       target="_blank" rel="noopener"
                       class="btn btn-outline-info w-100 h-100 d-flex flex-column py-3 learning-btn-pdf">
                        <i class="fas fa-project-diagram fa-2x mb-2"></i>
                        Algoritmos MIT
                    </a>
                </div>
                <div class="col-md-4 col-sm-6">
                    <a href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world" 
                       target="_blank" rel="noopener"
                       class="btn btn-outline-warning w-100 h-100 d-flex flex-column py-3 learning-btn-pdf">
                        <i class="fas fa-flask fa-2x mb-2"></i>
                        Mega Tutorial Flask
                    </a>
                </div>
                <div class="col-md-4 col-sm-6">
                    <a href="https://getbootstrap.com/docs/5.1/getting-started/introduction/" 
                       target="_blank" rel="noopener"
                       class="btn btn-outline-danger w-100 h-100 d-flex flex-column py-3 learning-btn-pdf">
                        <i class="fab fa-bootstrap fa-2x mb-2"></i>
                        Bootstrap Docs
                    </a>
                </div>
                <div class="col-md-4 col-sm-6">
                    <a href="https://jakevdp.github.io/PythonDataScienceHandbook/" 
                       target="_blank" rel="noopener"
                       class="btn btn-outline-dark w-100 h-100 d-flex flex-column py-3 learning-btn-pdf">
                        <i class="fas fa-chart-bar fa-2x mb-2"></i>
                        Data Science
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center mt-3 mb-5">
        <a href="{{ url_for('index') }}" class="btn btn-primary btn-lg">
            <i class="fas fa-home me-2"></i>Volver al Inicio
        </a>
    </div>
</div>

<!-- Modal para vista previa de PDF -->
<div class="modal fade" id="pdfPreviewModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="pdfModalTitle">Vista Previa</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="ratio ratio-16x9">
                    <iframe id="pdfPreviewFrame" src="" allowfullscreen></iframe>
                </div>
            </div>
            <div class="modal-footer">
                <a id="downloadPdfBtn" href="#" class="btn btn-success me-auto">
                    <i class="fas fa-download me-2"></i>Descargar
                </a>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-2"></i>Cerrar
                </button>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animación de texto para botones de recursos
    function animateTextFlyOut(element) {
        const text = element.textContent.trim();
        if (!text) return;
        
        element.innerHTML = '';
        
        text.split('').forEach((char, index) => {
            const span = document.createElement('span');
            span.textContent = char === ' ' ? '&nbsp;' : char;
            span.style.display = 'inline-block';
            span.style.transition = 'transform 0.5s ease, opacity 0.5s ease';
            span.style.transitionDelay = `${index * 0.05}s`;
            element.appendChild(span);
            
            setTimeout(() => {
                span.style.transform = `translate(${Math.random() * 200 - 100}px, ${Math.random() * 200 - 100}px) rotate(${Math.random() * 720 - 360}deg)`;
                span.style.opacity = '0';
            }, 50);
        });
        
        setTimeout(() => { 
            element.textContent = text; 
        }, text.length * 100 + 1000);
    }

    // Configuración de eventos para botones de recursos
    document.querySelectorAll('.learning-btn-pdf').forEach(btn => {
        btn.addEventListener('mouseenter', function() {
            animateTextFlyOut(this.querySelector('span') || this);
        });
    });

    // Vista previa de PDFs
    const pdfModal = new bootstrap.Modal('#pdfPreviewModal');
    const pdfFrame = document.getElementById('pdfPreviewFrame');
    const pdfTitle = document.getElementById('pdfModalTitle');
    const downloadBtn = document.getElementById('downloadPdfBtn');
    
    document.querySelectorAll('.pdf-link').forEach(link => {
        link.addEventListener('click', function(e) {
            if (this.dataset.pdf) {
                e.preventDefault();
                pdfFrame.src = this.dataset.pdf;
                downloadBtn.href = this.dataset.pdf;
                pdfTitle.textContent = this.textContent.trim();
                pdfModal.show();
            }
        });
    });
    
    pdfModal._element.addEventListener('hidden.bs.modal', function() {
        pdfFrame.src = '';
    });
});
</script>
{% endblock %}